<p-dialog
  [header]="'DIALOG.HISTORY.HEADER' | translate"
  [(visible)]="displayDialog"
  (onHide)="onDialogHide()"
  [modal]="true"
  [closable]="true"
  [draggable]="true"
  [resizable]="true"
  [maximizable]="true"
>
  <app-history-criteria [parameter]="parameter" (criteriaEmitter)="onSearch($event)"></app-history-criteria>

  <p-tabView>
    <p-tabPanel
      [header]="'DIALOG.HISTORY.TAB.LIST' | translate"
      [tooltip]="'DIALOG.HISTORY.TAB.TOOLTIPS.LIST' | translate"
      tooltipPosition="top"
      tooltipEvent="hover"
    >
      <p-message
        *ngIf="loading"
        id="pm_history_message_loading"
        severity="info"
        styleClass="my-3"
        [text]="'ACTIONS.LOADING' | translate"
      ></p-message>
      <p-message
        *ngIf="exceptionKey"
        id="pm_history_message_error"
        severity="error"
        styleClass="my-3"
        [text]="exceptionKey | translate"
      ></p-message>

      <app-history-list
        *ngIf="!loading && !exceptionKey"
        [parameter]="parameter"
        [dateFormat]="dateFormat"
        [data]="(data$ | async) ?? []"
      ></app-history-list>
    </p-tabPanel>

    <p-tabPanel
      *ngIf="!loading && !exceptionKey"
      [header]="'DIALOG.HISTORY.TAB.OVERVIEW' | translate"
      [tooltip]="'DIALOG.HISTORY.TAB.TOOLTIPS.OVERVIEW' | translate"
      tooltipPosition="top"
      tooltipEvent="hover"
    >
    </p-tabPanel>
  </p-tabView>

  <ng-template pTemplate="footer">
    <div class="flex flex-wrap justify-content-end gap-2 mb-1">
      <p-button
        id="pm_history_action_close"
        icon="pi pi-times"
        (onClick)="onDialogHide()"
        [label]="'ACTIONS.NAVIGATION.CLOSE' | translate"
        [ariaLabel]="'ACTIONS.NAVIGATION.CLOSE' | translate"
        [pTooltip]="'ACTIONS.NAVIGATION.CLOSE.TOOLTIP' | translate"
        tooltipPosition="top"
        tooltipEvent="hover"
      ></p-button>
    </div>
  </ng-template>
</p-dialog>
